<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Night Secret - –¢–µ—Ä–∏—Ç–æ—Ä—ñ—è –∑–∞–¥–æ–≤–æ–ª–µ–Ω–Ω—è</title>
    
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üî•</text></svg>">

    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700;800&display=swap" rel="stylesheet">

    <style>
        body { font-family: 'Montserrat', sans-serif; }
        .animate-fade-in { animation: fadeIn 0.5s ease-out; }
        .animate-fade-fast { animation: fadeIn 0.3s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #0f172a; }
        ::-webkit-scrollbar-thumb { background: #7c3aed; border-radius: 4px; }
    </style>
</head>
<body class="bg-slate-900 text-gray-100">
    
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // --- –Ü–ö–û–ù–ö–ò ---
        const IconBase = ({ children, size = 24, className = "" }) => (
            <svg xmlns="http://www.w3.org/2000/svg" width={size} height={size} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>{children}</svg>
        );

        const Icons = {
            ShoppingBag: (p) => <IconBase {...p}><path d="M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z"/><path d="M3 6h18"/><path d="M16 10a4 4 0 0 1-8 0"/></IconBase>,
            X: (p) => <IconBase {...p}><path d="M18 6 6 18"/><path d="m6 6 12 12"/></IconBase>,
            Star: (p) => <IconBase {...p}><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></IconBase>,
            Lock: (p) => <IconBase {...p}><rect width="18" height="11" x="3" y="11" rx="2" ry="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></IconBase>,
            Trash2: (p) => <IconBase {...p}><path d="M3 6h18"/><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/><path d="M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/><line x1="10" x2="10" y1="11" y2="17"/><line x1="14" x2="14" y1="11" y2="17"/></IconBase>,
            Plus: (p) => <IconBase {...p}><path d="M5 12h14"/><path d="M12 5v14"/></IconBase>,
            Minus: (p) => <IconBase {...p}><path d="M5 12h14"/></IconBase>,
            Edit2: (p) => <IconBase {...p}><path d="M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"/></IconBase>,
            Menu: (p) => <IconBase {...p}><line x1="4" x2="20" y1="12" y2="12"/><line x1="4" x2="20" y1="6" y2="6"/><line x1="4" x2="20" y1="18" y2="18"/></IconBase>,
            ArrowLeft: (p) => <IconBase {...p}><path d="m12 19-7-7 7-7"/><path d="M19 12H5"/></IconBase>,
            Settings: (p) => <IconBase {...p}><path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.47a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"/><circle cx="12" cy="12" r="3"/></IconBase>,
            ChevronRight: (p) => <IconBase {...p}><path d="m9 18 6-6-6-6"/></IconBase>,
            ChevronLeft: (p) => <IconBase {...p}><path d="m15 18-6-6 6-6"/></IconBase>,
            Truck: (p) => <IconBase {...p}><path d="M10 17h4V5H2v12h3"/><path d="M20 17h2v-3.34a4 4 0 0 0-1.17-2.83L19 9h-5"/><path d="M14 17h1"/><circle cx="7.5" cy="17.5" r="2.5"/><circle cx="17.5" cy="17.5" r="2.5"/></IconBase>,
            ShieldCheck: (p) => <IconBase {...p}><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10"/><path d="m9 12 2 2 4-4"/></IconBase>,
            Flame: (p) => <IconBase {...p}><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.1.2-2.2.6-3.3.7.3 1.9.9 2.9 1.8Z"/></IconBase>,
            LogOut: (p) => <IconBase {...p}><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/><polyline points="16 17 21 12 16 7"/><line x1="21" x2="9" y1="12" y2="12"/></IconBase>,
            Image: (p) => <IconBase {...p}><rect width="18" height="18" x="3" y="3" rx="2" ry="2"/><circle cx="9" cy="9" r="2"/><path d="m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21"/></IconBase>,
            Upload: (p) => <IconBase {...p}><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" x2="12" y1="3" y2="15"/></IconBase>,
            Check: (p) => <IconBase {...p}><polyline points="20 6 9 17 4 12"/></IconBase>,
            Video: (p) => <IconBase {...p}><path d="m22 8-6 4 6 4V8Z"/><rect width="14" height="12" x="2" y="6" rx="2" ry="2"/></IconBase>,
            Link: (p) => <IconBase {...p}><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/></IconBase>,
            Phone: (p) => <IconBase {...p}><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/></IconBase>,
            Instagram: (p) => <IconBase {...p}><rect width="20" height="20" x="2" y="2" rx="5" ry="5"/><path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"/><line x1="17.5" x2="17.51" y1="6.5" y2="6.5"/></IconBase>,
            Send: (p) => <IconBase {...p}><line x1="22" x2="11" y1="2" y2="13"/><polygon points="22 2 15 22 11 13 2 9 22 2"/></IconBase>
        };

        const BrandLogo = () => (
            <svg width="40" height="40" viewBox="0 0 40 40" fill="none" className="text-white drop-shadow-lg filter">
                <circle cx="20" cy="20" r="20" fill="url(#paint0_linear)" />
                <path d="M26 12C26 12 22 14 22 20C22 26 26 28 26 28C22.5 30 18 29 15 26C12 23 12 17 15 14C18 11 22.5 10 26 12Z" fill="white"/>
                <path d="M29 16L30.5 19L33.5 19.5L31.5 21.5L32 24.5L29 23L26 24.5L26.5 21.5L24.5 19.5L27.5 19L29 16Z" fill="#FDE047"/>
                <defs>
                    <linearGradient id="paint0_linear" x1="0" y1="0" x2="40" y2="40" gradientUnits="userSpaceOnUse">
                        <stop stopColor="#7C3AED"/>
                        <stop offset="1" stopColor="#DB2777"/>
                    </linearGradient>
                </defs>
            </svg>
        );

        const POPULAR_CITIES = ["–ö–∏—ó–≤", "–•–∞—Ä–∫—ñ–≤", "–û–¥–µ—Å–∞", "–î–Ω—ñ–ø—Ä–æ", "–õ—å–≤—ñ–≤", "–ó–∞–ø–æ—Ä—ñ–∂–∂—è", "–í—ñ–Ω–Ω–∏—Ü—è", "–•–º–µ–ª—å–Ω–∏—Ü—å–∫–∏–π", "–ñ–∏—Ç–æ–º–∏—Ä", "–ß–µ—Ä–Ω—ñ–≤—Ü—ñ", "–†—ñ–≤–Ω–µ", "–Ü–≤–∞–Ω–æ-–§—Ä–∞–Ω–∫—ñ–≤—Å—å–∫", "–¢–µ—Ä–Ω–æ–ø—ñ–ª—å", "–õ—É—Ü—å–∫", "–£–∂–≥–æ—Ä–æ–¥", "–ë—ñ–ª–∞ –¶–µ—Ä–∫–≤–∞", "–ö—Ä–æ–ø–∏–≤–Ω–∏—Ü—å–∫–∏–π", "–ú–∏–∫–æ–ª–∞—ó–≤", "–ü–æ–ª—Ç–∞–≤–∞", "–°—É–º–∏", "–ß–µ—Ä–∫–∞—Å–∏", "–ß–µ—Ä–Ω—ñ–≥—ñ–≤"];

        // --- –î–ê–ù–Ü ---
        const INITIAL_PRODUCTS = [
            { id: 1, name: "Rose Pleasure Deluxe", shortDesc: "–í–∞–∫—É—É–º–Ω–∏–π —Å—Ç–∏–º—É–ª—è—Ç–æ—Ä", description: "–Ü–Ω–Ω–æ–≤–∞—Ü—ñ–π–Ω–∏–π —Å—Ç–∏–º—É–ª—è—Ç–æ—Ä —É —Ñ–æ—Ä–º—ñ —Ç—Ä–æ—è–Ω–¥–∏. –ü–æ—î–¥–Ω—É—î –≤ —Å–æ–±—ñ –µ–ª–µ–≥–∞–Ω—Ç–Ω–∏–π –¥–∏–∑–∞–π–Ω —Ç–∞ –ø–æ—Ç—É–∂–Ω—ñ —Ç–µ—Ö–Ω–æ–ª–æ–≥—ñ—ó –∑–∞–¥–æ–≤–æ–ª–µ–Ω–Ω—è. –ú–∞—î 10 —Ä–µ–∂–∏–º—ñ–≤ –≤–∞–∫—É—É–º–Ω–æ—ó —Å—Ç–∏–º—É–ª—è—Ü—ñ—ó —Ç–∞ –ø–æ–≤–Ω—ñ—Å—Ç—é –≤–æ–¥–æ–Ω–µ–ø—Ä–æ–Ω–∏–∫–Ω–∏–π –∫–æ—Ä–ø—É—Å.", price: 2499, oldPrice: 3200, category: "–Ü–≥—Ä–∞—à–∫–∏", images: ["https://images.unsplash.com/photo-1595475207225-428b62bda831?auto=format&fit=crop&q=80&w=600", "https://images.unsplash.com/photo-1556905055-8f358a7a47b2?auto=format&fit=crop&q=80&w=600"], rating: 5.0, specs: ["–ú–∞—Ç–µ—Ä—ñ–∞–ª: –ú–µ–¥–∏—á–Ω–∏–π —Å–∏–ª—ñ–∫–æ–Ω", "–ñ–∏–≤–ª–µ–Ω–Ω—è: USB", "–í–æ–¥–æ–Ω–µ–ø—Ä–æ–Ω–∏–∫–Ω—ñ—Å—Ç—å: IPX7"], isHit: true },
            { id: 2, name: "Midnight Wand Pro", shortDesc: "–ü–æ—Ç—É–∂–Ω–∏–π –º–∞—Å–∞–∂–µ—Ä", description: "–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω–∏–π Magic Wand —É –±–µ–∑–¥—Ä–æ—Ç–æ–≤–æ–º—É —Ñ–æ—Ä–º–∞—Ç—ñ. –ì–ª–∏–±–æ–∫–∞ –≤—ñ–±—Ä–∞—Ü—ñ—è, —â–æ –∑–Ω—ñ–º–∞—î –Ω–∞–ø—Ä—É–≥—É –∑ –º'—è–∑—ñ–≤ —Ç–∞ –¥–∞—Ä—É—î –≤–∏–±—É—Ö–æ–≤–µ –∑–∞–¥–æ–≤–æ–ª–µ–Ω–Ω—è.", price: 1899, oldPrice: null, category: "–ú–∞—Å–∞–∂–µ—Ä–∏", images: ["https://images.unsplash.com/photo-1616423640778-28d1b53229bd?auto=format&fit=crop&q=80&w=600"], rating: 4.9, specs: ["–ú–∞—Ç–µ—Ä—ñ–∞–ª: ABS + –°–∏–ª—ñ–∫–æ–Ω", "–†–µ–∂–∏–º–∏: 20 –ø–∞—Ç–µ—Ä–Ω—ñ–≤"], isHit: false },
            { id: 3, name: "Silk Touch Oil", shortDesc: "–ú–∞—Å–∞–∂–Ω–∞ –æ–ª—ñ—è", description: "–†–æ–∑–∫—ñ—à–Ω–∞ –æ–ª—ñ—è –∑ –∞—Ä–æ–º–∞—Ç–æ–º —á–æ—Ä–Ω–æ—ó –æ—Ä—Ö—ñ–¥–µ—ó —Ç–∞ –≤–∞–Ω—ñ–ª—ñ. –ù–µ –∑–∞–ª–∏—à–∞—î –ª–∏–ø–∫–∏—Ö —Å–ª—ñ–¥—ñ–≤.", price: 450, oldPrice: 600, category: "–ö–æ—Å–º–µ—Ç–∏–∫–∞", images: ["https://images.unsplash.com/photo-1608248597279-f99d160bfbc8?auto=format&fit=crop&q=80&w=600"], rating: 4.8, specs: ["–û–±'—î–º: 100 –º–ª", "–û—Å–Ω–æ–≤–∞: –ù–∞—Ç—É—Ä–∞–ª—å–Ω—ñ –æ–ª—ñ—ó"], isHit: true },
            { id: 4, name: "Lace Fantasy Set", shortDesc: "–ö–æ–º–ø–ª–µ–∫—Ç –±—ñ–ª–∏–∑–Ω–∏", description: "–í–∏—à—É–∫–∞–Ω–∏–π –∫–æ–º–ø–ª–µ–∫—Ç –º–µ—Ä–µ–∂–∏–≤–Ω–æ—ó –±—ñ–ª–∏–∑–Ω–∏ —á–æ—Ä–Ω–æ–≥–æ –∫–æ–ª—å–æ—Ä—É. –ü—ñ–¥–∫—Ä–µ—Å–ª—é—î —Ñ—ñ–≥—É—Ä—É.", price: 1299, oldPrice: 1500, category: "–ë—ñ–ª–∏–∑–Ω–∞", images: ["https://images.unsplash.com/photo-1562572159-4efc207f5aff?auto=format&fit=crop&q=80&w=600"], rating: 5.0, specs: ["–ö–æ–ª—ñ—Ä: –ß–æ—Ä–Ω–∏–π", "–ú–∞—Ç–µ—Ä—ñ–∞–ª: –ú–µ—Ä–µ–∂–∏–≤–æ"], isHit: false }
        ];

        const CATEGORIES = [
            { name: "–ü—Ä–µ–∑–µ—Ä–≤–∞—Ç–∏–≤–∏", icon: "üõ°Ô∏è" },
            { name: "–õ—É–±—Ä–∏–∫–∞–Ω—Ç–∏", icon: "üíß" },
            { name: "–Ü–≥—Ä–∞—à–∫–∏", icon: "üß∏" },
            { name: "–ë—ñ–ª–∏–∑–Ω–∞", icon: "üëô" },
            { name: "–ú–∞—Å–∞–∂–µ—Ä–∏", icon: "üíÜ" }
        ];

        // --- –£–¢–ò–õ–Ü–¢–ò ---
        const isVideo = (url) => {
            if (!url) return false;
            return url.toLowerCase().endsWith('.mp4') || url.toLowerCase().endsWith('.webm');
        };

        // ==========================================
        // COMPONENTS
        // ==========================================

        const AddToCartBtn = ({ product, addToCart, variant = 'icon' }) => {
            const [added, setAdded] = useState(false);
            
            const handleClick = (e) => {
                e.stopPropagation();
                addToCart(product);
                setAdded(true);
                setTimeout(() => setAdded(false), 2000);
            };

            if (variant === 'icon') {
                return (
                    <button onClick={handleClick} className={`p-3 rounded-xl transition-all duration-300 z-20 ${added ? 'bg-green-500 text-white shadow-green-500/50 shadow-lg' : 'bg-white/10 hover:bg-violet-600 text-white'}`} title={added ? "–î–æ–¥–∞–Ω–æ" : "–í –∫–æ—à–∏–∫"}>
                        {added ? <Icons.Check size={20}/> : <Icons.ShoppingBag size={20}/>}
                    </button>
                );
            }
            
            return (
                <button onClick={handleClick} className={`flex-1 font-bold py-5 px-8 rounded-2xl shadow-lg flex items-center justify-center gap-3 transition-all duration-300 active:scale-95 ${added ? 'bg-green-600 hover:bg-green-700 text-white' : 'bg-violet-600 hover:bg-violet-700 text-white'}`}>
                    {added ? <Icons.Check size={24}/> : <Icons.ShoppingBag size={24}/>}
                    {added ? '–î–æ–¥–∞–Ω–æ!' : '–î–æ–¥–∞—Ç–∏ –≤ –∫–æ—à–∏–∫'}
                </button>
            );
        };

        const ProductCard = ({ product, navigateToProduct, addToCart }) => (
            <div className="group bg-slate-800 rounded-2xl border border-white/5 overflow-hidden hover:border-violet-500/50 transition-all duration-300 hover:shadow-2xl cursor-pointer flex flex-col h-full relative" onClick={() => navigateToProduct(product.id)}>
                <div className="relative aspect-[4/5] bg-slate-700 overflow-hidden">
                    {product.images && product.images.length > 0 ? (
                        isVideo(product.images[0]) ? (
                            <video src={product.images[0]} muted loop autoPlay playsInline className="w-full h-full object-cover group-hover:scale-110 transition-transform duration-700" />
                        ) : (
                            <img src={product.images[0]} alt={product.name} className="w-full h-full object-cover group-hover:scale-110 transition-transform duration-700"/>
                        )
                    ) : (
                        <div className="w-full h-full flex items-center justify-center bg-slate-800 text-gray-500"><Icons.Image size={40}/></div>
                    )}
                    
                    {product.isHit && <div className="absolute top-3 left-3 bg-fuchsia-600 text-white text-xs font-bold px-3 py-1 rounded-full shadow-lg z-10 flex items-center gap-1"><Icons.Flame size={12}/> HIT</div>}
                </div>
                <div className="p-5 flex-1 flex flex-col">
                    <div className="text-xs font-bold text-violet-400 uppercase tracking-wider mb-2">{product.category}</div>
                    <h3 className="text-lg font-bold text-white mb-1 group-hover:text-violet-300 transition-colors line-clamp-1">{product.name}</h3>
                    <p className="text-sm text-gray-400 mb-4 line-clamp-2">{product.shortDesc}</p>
                    <div className="mt-auto flex items-center justify-between">
                        <div><span className="text-2xl font-bold text-white">{product.price} ‚Ç¥</span>{product.oldPrice > 0 && <span className="text-sm text-gray-500 line-through ml-2">{product.oldPrice} ‚Ç¥</span>}</div>
                        <AddToCartBtn product={product} addToCart={addToCart} />
                    </div>
                </div>
            </div>
        );

        const ProductPage = ({ product, goBack, addToCart }) => {
            const [currentImg, setCurrentImg] = useState(0);
            
            if (!product) return (
                <div className="min-h-screen bg-slate-900 pt-20 flex items-center justify-center">
                    <div className="text-center">
                        <h2 className="text-2xl font-bold text-white mb-2">–¢–æ–≤–∞—Ä –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ</h2>
                        <button onClick={goBack} className="text-violet-400 hover:text-white font-bold">–ü–æ–≤–µ—Ä–Ω—É—Ç–∏—Å—å</button>
                    </div>
                </div>
            );

            const images = product.images || [];

            const nextImage = () => {
                setCurrentImg((prev) => (prev === images.length - 1 ? 0 : prev + 1));
            };

            const prevImage = () => {
                setCurrentImg((prev) => (prev === 0 ? images.length - 1 : prev - 1));
            };

            return (
                <div className="min-h-screen bg-slate-900 pb-20 pt-10 animate-fade-in">
                    <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                        <button onClick={goBack} className="flex items-center text-gray-400 hover:text-white mb-8 gap-2"><Icons.ArrowLeft size={20}/> –ù–∞–∑–∞–¥</button>
                        <div className="grid grid-cols-1 md:grid-cols-2 gap-12">
                            <div className="space-y-4 select-none">
                                <div className="aspect-square rounded-3xl overflow-hidden bg-slate-800 border border-white/10 shadow-2xl relative group">
                                    {images.length > 0 ? (
                                        <div key={currentImg} className="w-full h-full animate-fade-fast">
                                            {isVideo(images[currentImg]) ? (
                                                <video src={images[currentImg]} controls className="w-full h-full object-contain bg-black" />
                                            ) : (
                                                <img src={images[currentImg]} className="w-full h-full object-cover" />
                                            )}
                                        </div>
                                    ) : (
                                        <div className="w-full h-full flex items-center justify-center text-gray-600"><Icons.Image size={64}/></div>
                                    )}

                                    {images.length > 1 && (
                                        <>
                                            <button onClick={prevImage} className="absolute left-4 top-1/2 -translate-y-1/2 p-2 rounded-full bg-black/50 text-white hover:bg-violet-600 transition opacity-0 group-hover:opacity-100">
                                                <Icons.ChevronLeft size={24}/>
                                            </button>
                                            <button onClick={nextImage} className="absolute right-4 top-1/2 -translate-y-1/2 p-2 rounded-full bg-black/50 text-white hover:bg-violet-600 transition opacity-0 group-hover:opacity-100">
                                                <Icons.ChevronRight size={24}/>
                                            </button>
                                        </>
                                    )}
                                </div>
                                
                                {images.length > 1 && (
                                    <div className="flex gap-4 overflow-x-auto pb-2 scrollbar-hide">
                                        {images.map((img, idx) => (
                                            <button key={idx} onClick={() => setCurrentImg(idx)} className={`w-20 h-20 rounded-xl overflow-hidden border-2 flex-shrink-0 transition-all ${currentImg === idx ? 'border-violet-500 scale-105' : 'border-transparent opacity-70 hover:opacity-100'}`}>
                                                {isVideo(img) ? (
                                                    <div className="w-full h-full bg-black flex items-center justify-center"><Icons.Video size={24} className="text-white"/></div>
                                                ) : (
                                                    <img src={img} className="w-full h-full object-cover"/>
                                                )}
                                            </button>
                                        ))}
                                    </div>
                                )}
                            </div>
                            <div>
                                <div className="flex items-center gap-4 mb-4">
                                    <span className="px-3 py-1 rounded-full bg-violet-900/50 text-violet-300 text-sm font-bold">{product.category}</span>
                                    {product.isHit && <span className="flex items-center gap-1 text-yellow-400 text-sm font-bold"><Icons.Star fill="currentColor" size={16}/> 4.9</span>}
                                </div>
                                <h1 className="text-3xl md:text-5xl font-extrabold text-white mb-4">{product.name}</h1>
                                <div className="flex items-end gap-4 mb-8">
                                    <span className="text-4xl font-bold text-white">{product.price} ‚Ç¥</span>
                                    {product.oldPrice > 0 && <span className="text-xl text-gray-500 line-through mb-1">{product.oldPrice} ‚Ç¥</span>}
                                </div>
                                <p className="text-lg text-gray-300 leading-relaxed mb-10">{product.description}</p>
                                
                                {product.specs && product.specs.length > 0 && (
                                    <div className="bg-slate-800/50 rounded-2xl p-6 mb-10 border border-white/5">
                                        <h3 className="font-bold text-white mb-4">–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏</h3>
                                        <ul className="grid grid-cols-1 sm:grid-cols-2 gap-y-3 gap-x-8">
                                            {product.specs.map((spec, idx) => (
                                                <li key={idx} className="flex items-center text-gray-400 text-sm"><span className="w-1.5 h-1.5 rounded-full bg-violet-500 mr-3"></span>{spec}</li>
                                            ))}
                                        </ul>
                                    </div>
                                )}

                                <div className="flex gap-4">
                                    <AddToCartBtn product={product} addToCart={addToCart} variant="full" />
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        const CartView = ({ cart, updateQty, removeFromCart, goBack, cartTotal, changeRoute }) => {
            const [form, setForm] = useState({ name: '', phone: '', city: '', branch: '' });
            const [isSending, setIsSending] = useState(false);
            // –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ, —á–∏ –º–∏ –≤ —Ä–µ–∂–∏–º—ñ –æ—Ñ–æ—Ä–º–ª–µ–Ω–Ω—è (—á–µ—Ä–µ–∑ URL/History –∞–±–æ –ª–æ–∫–∞–ª—å–Ω–æ)
            // –î–ª—è —Å–ø—Ä–æ—â–µ–Ω–Ω—è —Ç—É—Ç: —è–∫—â–æ –∫–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞ - –ø–æ–∫–∞–∑—É—î–º–æ –ø—É—Å—Ç—É, —è–∫—â–æ –Ω—ñ - —Å–ø–∏—Å–æ–∫.
            // –û—Ñ–æ—Ä–º–ª–µ–Ω–Ω—è –∑—Ä–æ–±–∏–º–æ –æ–∫—Ä–µ–º–∏–º "—Ä–æ—É—Ç–æ–º" 'checkout'
            
            return (
                <div className="min-h-screen bg-slate-900 py-12 px-4 animate-fade-in">
                    <div className="max-w-3xl mx-auto">
                        <h1 className="text-3xl font-bold text-white mb-8">–ö–æ—à–∏–∫</h1>
                        {cart.length === 0 ? (
                            <div className="text-center py-20 bg-slate-800 rounded-2xl border border-white/10"><Icons.ShoppingBag size={64} className="mx-auto text-gray-600 mb-4"/><p className="text-gray-400">–ö–æ—à–∏–∫ –ø–æ—Ä–æ–∂–Ω—ñ–π</p><button onClick={() => changeRoute('home')} className="mt-4 text-violet-400 font-bold">–î–æ –ø–æ–∫—É–ø–æ–∫</button></div>
                        ) : (
                            <div className="space-y-6">
                                <div className="bg-slate-800 rounded-2xl border border-white/10 overflow-hidden">
                                    {cart.map(item => (
                                        <div key={item.id} className="p-4 flex gap-4 border-b border-white/5 items-center">
                                            <img src={item.images?.[0] || 'https://via.placeholder.com/100'} className="w-16 h-16 rounded object-cover"/>
                                            <div className="flex-1"><h3 className="font-bold">{item.name}</h3><p className="text-sm text-gray-400">{item.price} ‚Ç¥</p></div>
                                            <div className="flex items-center gap-3 bg-slate-900 rounded p-1"><button onClick={()=>updateQty(item.id, -1)} className="p-1 text-gray-400 hover:text-white"><Icons.Minus size={14}/></button><span className="text-sm font-bold w-4 text-center">{item.qty}</span><button onClick={()=>updateQty(item.id, 1)} className="p-1 text-gray-400 hover:text-white"><Icons.Plus size={14}/></button></div>
                                            <button onClick={()=>removeFromCart(item.id)} className="text-gray-500 hover:text-red-500"><Icons.Trash2 size={18}/></button>
                                        </div>
                                    ))}
                                </div>
                                <div className="flex justify-between items-center"><span className="text-gray-400">–†–∞–∑–æ–º:</span><span className="text-2xl font-bold text-violet-400">{cartTotal} ‚Ç¥</span></div>
                                <button onClick={() => changeRoute('checkout')} className="w-full bg-violet-600 hover:bg-violet-700 text-white font-bold py-4 rounded-xl">–û—Ñ–æ—Ä–º–∏—Ç–∏</button>
                            </div>
                        )}
                    </div>
                </div>
            );
        };

        const CheckoutView = ({ cart, cartTotal, goBack, clearCart, changeRoute }) => {
            const [form, setForm] = useState({ name: '', phone: '', city: '', branch: '' });
            const [isSending, setIsSending] = useState(false);
            const TELEGRAM_BOT_TOKEN = "8490403071:AAFZvriLL_vzQq-ziMVTfiHAu8DmtH84Fjk";
            const TELEGRAM_CHAT_ID = "7085928669";

            const submitOrder = async (e) => {
                e.preventDefault();
                setIsSending(true);
                const list = cart.map(i => `${i.name} (${i.qty} —à—Ç) - ${i.price * i.qty} –≥—Ä–Ω`).join('\n');
                const msg = `<b>üî• –ó–ê–ú–û–í–õ–ï–ù–ù–Ø!</b>\n\nüë§ ${form.name}\nüìû ${form.phone}\nüèô ${form.city}\nüì¶ ${form.branch}\n\nüõí:\n${list}\n\nüí∞ <b>${cartTotal} –≥—Ä–Ω</b>`;
                try {
                    await fetch(`https://api.telegram.org/bot${TELEGRAM_BOT_TOKEN}/sendMessage`, {
                        method: 'POST', headers: {'Content-Type': 'application/json'},
                        body: JSON.stringify({ chat_id: TELEGRAM_CHAT_ID, text: msg, parse_mode: 'HTML' })
                    });
                    alert("–î—è–∫—É—î–º–æ! –ó–∞–º–æ–≤–ª–µ–Ω–Ω—è –ø—Ä–∏–π–Ω—è—Ç–æ."); 
                    clearCart();
                    changeRoute('home');
                } catch (e) { alert("–ü–æ–º–∏–ª–∫–∞."); } finally { setIsSending(false); }
            };

            return (
                <div className="min-h-screen bg-slate-900 py-12 px-4 animate-fade-in">
                    <div className="max-w-3xl mx-auto">
                        <h1 className="text-3xl font-bold text-white mb-8">–û—Ñ–æ—Ä–º–ª–µ–Ω–Ω—è</h1>
                        <div className="bg-slate-800 rounded-2xl p-8 border border-white/10">
                            <button onClick={goBack} className="mb-6 flex items-center gap-2 text-gray-400 hover:text-white"><Icons.ArrowLeft size={16}/> –ù–∞–∑–∞–¥</button>
                            <form onSubmit={submitOrder} className="space-y-4">
                                <input required placeholder="–Ü–º'—è" className="w-full bg-slate-900 border border-white/10 rounded-xl px-4 py-3 outline-none focus:border-violet-500" value={form.name} onChange={e=>setForm({...form, name:e.target.value})} />
                                <input required placeholder="–¢–µ–ª–µ—Ñ–æ–Ω" className="w-full bg-slate-900 border border-white/10 rounded-xl px-4 py-3 outline-none focus:border-violet-500" value={form.phone} onChange={e=>setForm({...form, phone:e.target.value})} />
                                <div className="pt-4 border-t border-white/5"><h3 className="font-bold mb-4 flex gap-2"><Icons.Truck className="text-violet-500"/> –î–æ—Å—Ç–∞–≤–∫–∞</h3><div className="grid md:grid-cols-2 gap-4"><input required placeholder="–ú—ñ—Å—Ç–æ" list="cities" className="w-full bg-slate-900 border border-white/10 rounded-xl px-4 py-3 outline-none focus:border-violet-500" value={form.city} onChange={e=>setForm({...form, city:e.target.value})} /><datalist id="cities">{POPULAR_CITIES.map(c=><option key={c} value={c}/>)}</datalist><input required placeholder="–í—ñ–¥–¥—ñ–ª–µ–Ω–Ω—è ‚Ññ" className="w-full bg-slate-900 border border-white/10 rounded-xl px-4 py-3 outline-none focus:border-violet-500" value={form.branch} onChange={e=>setForm({...form, branch:e.target.value})} /></div></div>
                                <button disabled={isSending} className="w-full bg-violet-600 hover:bg-violet-700 text-white font-bold py-4 rounded-xl mt-6">{isSending ? '–í—ñ–¥–ø—Ä–∞–≤–∫–∞...' : `–ü—ñ–¥—Ç–≤–µ—Ä–¥–∏—Ç–∏ (${cartTotal} ‚Ç¥)`}</button>
                            </form>
                        </div>
                    </div>
                </div>
            );
        };

        const AdminPanel = ({ products, setProducts, setEditId }) => {
            const [localEditId, setLocalEditId] = useState(null);
            const [formData, setFormData] = useState(null);
            const [urlInput, setUrlInput] = useState("");

            const handleCreateNew = () => {
                const newProduct = { id: Date.now(), name: "–ù–æ–≤–∏–π —Ç–æ–≤–∞—Ä", price: 0, category: "–Ü–≥—Ä–∞—à–∫–∏", images: [], rating: 0, specs: [], isHit: false };
                setProducts([newProduct, ...products]);
                setLocalEditId(newProduct.id);
                setFormData(newProduct);
            };

            const handleEdit = (product) => {
                setLocalEditId(product.id);
                setFormData({...product});
            };

            const handleSave = (e) => {
                e.preventDefault();
                setProducts(products.map(p => p.id === formData.id ? formData : p));
                setLocalEditId(null);
            };

            const handleImageUpload = (e) => {
                Array.from(e.target.files).forEach(file => {
                    const reader = new FileReader();
                    reader.onloadend = () => setFormData(p => ({...p, images: [...p.images, reader.result]}));
                    reader.readAsDataURL(file);
                });
            };

            const handleAddUrl = () => {
                if(urlInput) {
                    setFormData(p => ({...p, images: [...p.images, urlInput]}));
                    setUrlInput("");
                }
            };

            const removeImage = (index) => {
                setFormData(prev => ({...prev, images: prev.images.filter((_, i) => i !== index)}));
            };

            const addSpec = () => setFormData({...formData, specs: [...(formData.specs || []), ""]});
            const updateSpec = (i, val) => {
                const newSpecs = [...(formData.specs || [])];
                newSpecs[i] = val;
                setFormData({...formData, specs: newSpecs});
            };
            const removeSpec = (i) => setFormData({...formData, specs: formData.specs.filter((_, idx) => idx !== i)});

            if (localEditId && formData) {
                return (
                    <div className="min-h-screen bg-slate-900 py-12 px-4 animate-fade-in">
                        <div className="max-w-4xl mx-auto bg-slate-800 p-8 rounded-2xl border border-white/10">
                            <div className="flex justify-between items-center mb-8"><h2 className="text-2xl font-bold text-white">–†–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è</h2><button onClick={()=>setLocalEditId(null)} className="text-gray-400 hover:text-white"><Icons.X/></button></div>
                            <form onSubmit={handleSave} className="space-y-6">
                                <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                                    <div><label className="block text-sm font-bold text-gray-400 mb-2">–ù–∞–∑–≤–∞</label><input value={formData.name} onChange={e=>setFormData({...formData, name:e.target.value})} className="w-full bg-slate-900 border border-white/10 rounded-xl px-4 py-3 text-white outline-none focus:border-violet-500" /></div>
                                    <div><label className="block text-sm font-bold text-gray-400 mb-2">–¶—ñ–Ω–∞</label><input type="number" value={formData.price} onChange={e=>setFormData({...formData, price:Number(e.target.value)})} className="w-full bg-slate-900 border border-white/10 rounded-xl px-4 py-3 text-white outline-none focus:border-violet-500" /></div>
                                    <div><label className="block text-sm font-bold text-gray-400 mb-2">–ö–∞—Ç–µ–≥–æ—Ä—ñ—è</label><select value={formData.category} onChange={e=>setFormData({...formData, category:e.target.value})} className="w-full bg-slate-900 border border-white/10 rounded-xl px-4 py-3 text-white outline-none focus:border-violet-500">{CATEGORIES.map(c=><option key={c.name} value={c.name}>{c.name}</option>)}<option value="–Ü–Ω—à–µ">–Ü–Ω—à–µ</option></select></div>
                                    <div><label className="block text-sm font-bold text-gray-400 mb-2">–°—Ç–∞—Ä–∞ —Ü—ñ–Ω–∞ (–Ω–µ–æ–±–æ–≤'—è–∑–∫–æ–≤–æ)</label><input type="number" value={formData.oldPrice || ''} onChange={e=>setFormData({...formData, oldPrice:Number(e.target.value)})} className="w-full bg-slate-900 border border-white/10 rounded-xl px-4 py-3 text-white outline-none focus:border-violet-500" placeholder="0" /></div>
                                </div>
                                
                                <div>
                                    <label className="block text-sm font-bold text-gray-400 mb-2">–ú–µ–¥—ñ–∞ (–§–æ—Ç–æ/–í—ñ–¥–µ–æ)</label>
                                    <div className="flex flex-wrap gap-4 mb-4">
                                        {formData.images?.map((img, i) => (
                                            <div key={i} className="relative w-24 h-24 rounded-lg overflow-hidden border border-white/20 group bg-black">
                                                {isVideo(img) ? <video src={img} className="w-full h-full object-cover"/> : <img src={img} className="w-full h-full object-cover"/>}
                                                <button type="button" onClick={() => removeImage(i)} className="absolute inset-0 bg-black/50 flex items-center justify-center opacity-0 group-hover:opacity-100 transition text-red-500"><Icons.Trash2/></button>
                                            </div>
                                        ))}
                                        <label className="w-24 h-24 rounded-lg border-2 border-dashed border-white/20 flex flex-col items-center justify-center text-gray-400 cursor-pointer hover:border-violet-500 hover:text-violet-500 transition">
                                            <Icons.Upload size={24}/>
                                            <span className="text-xs mt-1">–§–∞–π–ª</span>
                                            <input type="file" multiple className="hidden" onChange={handleImageUpload}/>
                                        </label>
                                    </div>
                                    <div className="flex gap-2">
                                        <input value={urlInput} onChange={e => setUrlInput(e.target.value)} placeholder="–í—Å—Ç–∞–≤—Ç–µ –ø–æ—Å–∏–ª–∞–Ω–Ω—è –Ω–∞ —Ñ–æ—Ç–æ –∞–±–æ .mp4 –≤—ñ–¥–µ–æ" className="flex-1 bg-slate-900 border border-white/10 rounded-xl px-4 py-2 text-white outline-none focus:border-violet-500 text-sm"/>
                                        <button type="button" onClick={handleAddUrl} className="bg-slate-700 hover:bg-violet-600 text-white px-4 rounded-xl text-sm font-bold">–î–æ–¥–∞—Ç–∏ URL</button>
                                    </div>
                                </div>

                                <div><label className="block text-sm font-bold text-gray-400 mb-2">–û–ø–∏—Å</label><textarea rows={4} value={formData.description} onChange={e=>setFormData({...formData, description:e.target.value})} className="w-full bg-slate-900 border border-white/10 rounded-xl px-4 py-3 text-white outline-none focus:border-violet-500" /></div>
                                
                                <div className="bg-slate-900 p-4 rounded-xl border border-white/10">
                                    <div className="flex justify-between items-center mb-4"><label className="block text-sm font-bold text-gray-400">–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏</label><button type="button" onClick={addSpec} className="text-xs bg-violet-600 px-3 py-1 rounded text-white">–î–æ–¥–∞—Ç–∏</button></div>
                                    <div className="space-y-2">
                                        {formData.specs?.map((spec, i) => (
                                            <div key={i} className="flex gap-2"><input value={spec} onChange={e => updateSpec(i, e.target.value)} className="flex-1 bg-slate-800 border border-white/10 rounded px-3 py-2 text-white outline-none" /><button type="button" onClick={() => removeSpec(i)} className="text-red-500 hover:text-red-400"><Icons.Trash2 size={18}/></button></div>
                                        ))}
                                    </div>
                                </div>

                                <button className="bg-violet-600 text-white font-bold py-3 px-8 rounded-xl">–ó–±–µ—Ä–µ–≥—Ç–∏</button>
                            </form>
                        </div>
                    </div>
                );
            }

            return (
                <div className="min-h-screen bg-slate-900 py-12 px-4 animate-fade-in">
                    <div className="max-w-6xl mx-auto">
                        <div className="flex justify-between items-center mb-8"><h1 className="text-3xl font-bold text-white flex items-center gap-3"><Icons.Settings className="text-violet-500" /> –ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä—É–≤–∞–Ω–Ω—è</h1><button onClick={handleCreateNew} className="flex items-center gap-2 bg-violet-600 text-white px-4 py-2 rounded-lg hover:bg-violet-700 transition font-bold"><Icons.Plus size={18}/> –ù–æ–≤–∏–π —Ç–æ–≤–∞—Ä</button></div>
                        <div className="bg-slate-800 rounded-2xl border border-white/10 overflow-hidden">
                            <table className="w-full text-left"><tbody className="divide-y divide-white/5">{products.map(p=><tr key={p.id} className="hover:bg-white/5 transition"><td className="p-4 font-bold text-white">{p.name}</td><td className="p-4 text-white">{p.price} ‚Ç¥</td><td className="p-4 text-right"><button onClick={()=>handleEdit(p)} className="bg-slate-700 hover:bg-violet-600 text-white p-2 rounded-lg transition"><Icons.Edit2 size={16}/></button></td></tr>)}</tbody></table>
                        </div>
                    </div>
                </div>
            );
        };

        const Header = ({ goHome, changeRoute, cart, isMobileMenuOpen, setIsMobileMenuOpen, isAdminMode, setIsAdminMode }) => (
            <nav className="sticky top-0 z-50 bg-slate-900/95 backdrop-blur-md border-b border-white/10 shadow-lg">
                <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                    <div className="flex justify-between items-center h-20">
                        <div className="flex items-center gap-3 cursor-pointer group" onClick={goHome}>
                            <BrandLogo />
                            <div className="flex flex-col"><span className="text-xl font-black text-white tracking-wide leading-none">NIGHT</span><span className="text-sm font-bold text-violet-400 tracking-[0.2em] leading-none">SECRET</span></div>
                        </div>
                        <div className="hidden md:flex items-center space-x-8 text-sm font-medium text-gray-300">
                            <button onClick={goHome} className="hover:text-white transition-colors">–ì–æ–ª–æ–≤–Ω–∞</button>
                            <button onClick={() => { changeRoute('home'); setTimeout(() => document.getElementById('categories')?.scrollIntoView({behavior:'smooth'}), 100)}} className="hover:text-white transition-colors">–ö–∞—Ç–µ–≥–æ—Ä—ñ—ó</button>
                        </div>
                        <div className="flex items-center gap-4">
                            {isAdminMode && <button onClick={() => setIsAdminMode(false)} className="flex items-center gap-2 px-3 py-2 rounded-full bg-red-600 text-white text-xs font-bold uppercase"><Icons.LogOut size={16} /> –í–∏—Ö—ñ–¥</button>}
                            <button onClick={() => { changeRoute('cart'); setIsMobileMenuOpen(false); }} className="relative p-2 text-gray-400 hover:text-white transition-colors">
                                <Icons.ShoppingBag size={24} />
                                {cart.length > 0 && <span className="absolute -top-1 -right-1 bg-fuchsia-600 text-white text-[10px] font-bold w-5 h-5 flex items-center justify-center rounded-full animate-bounce">{cart.reduce((a,b) => a + b.qty, 0)}</span>}
                            </button>
                            <button className="md:hidden p-2 text-gray-400 hover:text-white" onClick={() => setIsMobileMenuOpen(!isMobileMenuOpen)}>{isMobileMenuOpen ? <Icons.X size={24} /> : <Icons.Menu size={24} />}</button>
                        </div>
                    </div>
                </div>
                {isMobileMenuOpen && (
                    <div className="md:hidden bg-slate-900 border-b border-white/10 animate-fade-in p-4 space-y-2">
                        <button onClick={goHome} className="block w-full text-left px-3 py-3 text-white hover:bg-white/5 rounded-lg">–ì–æ–ª–æ–≤–Ω–∞</button>
                        <button onClick={() => { changeRoute('cart'); setIsMobileMenuOpen(false); }} className="block w-full text-left px-3 py-3 text-white hover:bg-white/5 rounded-lg">–ö–æ—à–∏–∫</button>
                    </div>
                )}
            </nav>
        );

        // --- MAIN APP COMPONENT ---
        const App = () => {
            const [activeView, setActiveView] = useState('home'); 
            const [products, setProducts] = useState(INITIAL_PRODUCTS);
            const [selectedProductId, setSelectedProductId] = useState(null);
            const [cart, setCart] = useState([]);
            const [isAdminMode, setIsAdminMode] = useState(false);
            const [isMobileMenuOpen, setIsMobileMenuOpen] = useState(false);
            const [isAgeVerified, setIsAgeVerified] = useState(false);
            const [showAdminLogin, setShowAdminLogin] = useState(false);
            const [adminPassInput, setAdminPassInput] = useState("");
            const [filterCategory, setFilterCategory] = useState(null);

            // --- HISTORY API HANDLING ---
            useEffect(() => {
                const verified = localStorage.getItem('ageVerified_v2');
                if (verified === 'true') setIsAgeVerified(true);

                // Initial state replacement
                window.history.replaceState({ view: 'home' }, '');

                const handlePopState = (event) => {
                    const state = event.state;
                    if (state) {
                        const { view, productId, category } = state;
                        setActiveView(view);
                        if (productId) setSelectedProductId(productId);
                        if (category !== undefined) setFilterCategory(category);
                        setIsMobileMenuOpen(false);
                        setShowAdminLogin(false);
                    } else {
                        // Fallback
                        setActiveView('home');
                        setFilterCategory(null);
                        setSelectedProductId(null);
                    }
                };

                window.addEventListener('popstate', handlePopState);
                return () => window.removeEventListener('popstate', handlePopState);
            }, []);

            const changeRoute = (view, params = {}) => {
                const newState = { view, ...params };
                window.history.pushState(newState, '');
                
                setActiveView(view);
                if (params.productId) setSelectedProductId(params.productId);
                if (params.category !== undefined) setFilterCategory(params.category);
                
                setIsMobileMenuOpen(false);
                window.scrollTo(0, 0);
            };

            const goBack = () => {
                window.history.back();
            };

            // Helpers wrappers for History API
            const navigateToProduct = (id) => changeRoute('product', { productId: id });
            const goHome = () => changeRoute('home', { category: null, productId: null });
            const goToCategory = (cat) => {
                changeRoute('home', { category: cat });
                // Need a small timeout to scroll because rendering happens async
                setTimeout(() => document.getElementById('products-grid')?.scrollIntoView({behavior:'smooth'}), 100);
            };

            const confirmAge = () => {
                localStorage.setItem('ageVerified_v2', 'true');
                setIsAgeVerified(true);
            };

            const addToCart = (product) => {
                const existing = cart.find(item => item.id === product.id);
                if (existing) {
                    setCart(cart.map(item => item.id === product.id ? {...item, qty: item.qty + 1} : item));
                } else {
                    setCart([...cart, {...product, qty: 1}]);
                }
            };

            const updateQty = (id, delta) => setCart(cart.map(item => item.id === id ? { ...item, qty: Math.max(1, item.qty + delta) } : item));
            const removeFromCart = (id) => setCart(cart.filter(item => item.id !== id));
            const clearCart = () => setCart([]);
            const cartTotal = cart.reduce((sum, item) => sum + item.price * item.qty, 0);

            const displayedProducts = filterCategory ? products.filter(p => p.category === filterCategory) : products;

            if (!isAgeVerified) return (
                <div className="fixed inset-0 z-[100] bg-slate-900 flex items-center justify-center p-4">
                    <div className="bg-slate-800 p-8 rounded-3xl max-w-md w-full text-center border border-purple-500/30 shadow-2xl">
                        <div className="mb-6 inline-block p-4 bg-purple-600/20 rounded-full text-purple-400"><Icons.ShieldCheck size={48} /></div>
                        <h2 className="text-2xl font-bold text-white mb-4">–í–∞–º –≤–∏–ø–æ–≤–Ω–∏–ª–æ—Å—è 18 —Ä–æ–∫—ñ–≤?</h2>
                        <div className="flex gap-4"><button onClick={() => window.location.href = 'https://google.com'} className="flex-1 py-3 px-4 rounded-xl border border-gray-600 text-gray-300">–ù—ñ</button><button onClick={confirmAge} className="flex-1 py-3 px-4 rounded-xl bg-purple-600 text-white font-bold">–¢–∞–∫, –º–µ–Ω—ñ 18+</button></div>
                    </div>
                </div>
            );

            return (
                <div className="min-h-screen bg-slate-900 text-gray-100 font-sans selection:bg-violet-600 selection:text-white">
                    {showAdminLogin && (
                        <div className="fixed inset-0 z-[60] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4" onClick={() => setShowAdminLogin(false)}>
                            <div className="bg-slate-800 p-8 rounded-2xl max-w-sm w-full border border-white/10" onClick={e => e.stopPropagation()}>
                                <h3 className="text-xl font-bold text-white mb-6 text-center">–í—Ö—ñ–¥ –≤ –∞–¥–º—ñ–Ω–∫—É</h3>
                                <input type="password" autoFocus className="w-full bg-slate-900 border border-white/20 rounded-xl px-4 py-3 text-white mb-6 outline-none" placeholder="–ü–∞—Ä–æ–ª—å" value={adminPassInput} onChange={e => setAdminPassInput(e.target.value)}/>
                                <button onClick={(e) => { e.preventDefault(); if (adminPassInput === "lux1412") { setIsAdminMode(true); setShowAdminLogin(false); setAdminPassInput(""); } else alert("–ù–µ–≤—ñ—Ä–Ω–∏–π –ø–∞—Ä–æ–ª—å!"); }} className="w-full bg-purple-600 text-white font-bold py-3 rounded-xl">–£–≤—ñ–π—Ç–∏</button>
                            </div>
                        </div>
                    )}
                    
                    <Header goHome={goHome} changeRoute={changeRoute} cart={cart} isMobileMenuOpen={isMobileMenuOpen} setIsMobileMenuOpen={setIsMobileMenuOpen} isAdminMode={isAdminMode} setIsAdminMode={setIsAdminMode} />
                    
                    <main>
                        {isAdminMode ? <AdminPanel products={products} setProducts={setProducts} setEditId={setSelectedProductId} /> : 
                         activeView === 'product' ? <ProductPage product={products.find(p => p.id === selectedProductId)} goBack={goBack} addToCart={addToCart} goHome={goHome} /> : 
                         activeView === 'cart' ? <CartView cart={cart} updateQty={updateQty} removeFromCart={removeFromCart} goHome={goHome} cartTotal={cartTotal} changeRoute={changeRoute} /> : 
                         activeView === 'checkout' ? <CheckoutView cart={cart} cartTotal={cartTotal} goBack={goBack} clearCart={clearCart} changeRoute={changeRoute} /> :
                         (
                            <>
                                <div className="relative overflow-hidden bg-slate-900 py-16 sm:py-24 text-center">
                                    <h1 className="text-4xl md:text-6xl font-extrabold text-white mb-8">–í—ñ–¥–∫—Ä–∏–π —Å–≤–æ—ó <br/><span className="text-transparent bg-clip-text bg-gradient-to-r from-violet-400 to-fuchsia-500">—Ç–∞—î–º–Ω—ñ –±–∞–∂–∞–Ω–Ω—è</span></h1>
                                    <button onClick={() => document.getElementById('products-grid').scrollIntoView({behavior: 'smooth'})} className="px-8 py-4 bg-violet-600 hover:bg-violet-700 text-white rounded-xl font-bold transition-all shadow-lg flex items-center justify-center gap-2 mx-auto"><Icons.ShoppingBag size={20} /> –ü–µ—Ä–µ–π—Ç–∏ –¥–æ –∫–∞—Ç–∞–ª–æ–≥—É</button>
                                </div>
                                <div id="categories" className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
                                    <h2 className="text-2xl font-bold text-white mb-6">–ü–æ–ø—É–ª—è—Ä–Ω—ñ –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó</h2>
                                    <div className="grid grid-cols-2 md:grid-cols-5 gap-4">
                                        {CATEGORIES.map(cat => <button key={cat.name} onClick={() => goToCategory(cat.name)} className={`p-4 rounded-2xl border border-white/10 bg-slate-800 hover:bg-slate-700 transition flex flex-col items-center gap-2 ${filterCategory === cat.name ? 'ring-2 ring-violet-500 bg-slate-700' : ''}`}><span className="text-3xl">{cat.icon}</span><span className="text-sm font-bold">{cat.name}</span></button>)}
                                    </div>
                                </div>
                                <div id="products-grid" className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 pb-20">
                                    <div className="flex items-end justify-between mb-8"><h2 className="text-3xl font-bold text-white">{filterCategory ? `–ö–∞—Ç–µ–≥–æ—Ä—ñ—è: ${filterCategory}` : '–í—Å—ñ —Ç–æ–≤–∞—Ä–∏'}</h2>{filterCategory && <button onClick={() => setFilterCategory(null)} className="text-violet-400 hover:text-white text-sm">–ü–æ–∫–∞–∑–∞—Ç–∏ –≤—Å—ñ</button>}</div>
                                    <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-8">
                                        {displayedProducts.map(product => <ProductCard key={product.id} product={product} navigateToProduct={navigateToProduct} addToCart={addToCart} />)}
                                    </div>
                                </div>
                            </>
                         )
                        }
                    </main>
                    
                    <footer className="bg-slate-950 border-t border-white/10 pt-16 pb-8">
                        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                            <div className="grid grid-cols-1 md:grid-cols-3 gap-12 mb-12">
                                <div>
                                    <div className="flex items-center gap-3 mb-4">
                                        <BrandLogo />
                                        <div className="flex flex-col">
                                            <span className="text-lg font-black text-white tracking-wide leading-none">NIGHT</span>
                                            <span className="text-xs font-bold text-violet-400 tracking-[0.2em] leading-none">SECRET</span>
                                        </div>
                                    </div>
                                    <p className="text-gray-500 text-sm leading-relaxed">
                                        –õ–∞—Å–∫–∞–≤–æ –ø—Ä–æ—Å–∏–º–æ –¥–æ Night Secret ‚Äî –º—ñ—Å—Ü—è, –¥–µ –≤–∞—à—ñ –Ω–∞–π—Å–º—ñ–ª–∏–≤—ñ—à—ñ —Ñ–∞–Ω—Ç–∞–∑—ñ—ó —Å—Ç–∞—é—Ç—å —Ä–µ–∞–ª—å–Ω—ñ—Å—Ç—é. –ú–∏ –¥–±–∞—î–º–æ –ø—Ä–æ –≤–∞—à—É –∫–æ–Ω—Ñ—ñ–¥–µ–Ω—Ü—ñ–π–Ω—ñ—Å—Ç—å —Ç–∞ –∫–æ–º—Ñ–æ—Ä—Ç, –ø—Ä–æ–ø–æ–Ω—É—é—á–∏ –ª–∏—à–µ –Ω–∞–π–∫—Ä–∞—â—ñ —Ç–æ–≤–∞—Ä–∏ –¥–ª—è –∑–∞–¥–æ–≤–æ–ª–µ–Ω–Ω—è. –î–æ–∑–≤–æ–ª—å—Ç–µ —Å–æ–±—ñ –±—ñ–ª—å—à–µ, –≤—ñ–¥–∫—Ä–∏–π—Ç–µ –Ω–æ–≤—ñ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∏ —á—É—Ç—Ç—î–≤–æ—Å—Ç—ñ —Ç–∞ –Ω–∞—Å–æ–ª–æ–¥–∏. –í–∞—à–∞ —Ç–∞—î–º–Ω–∏—Ü—è –∑–∞–ª–∏—à–∏—Ç—å—Å—è –∑ –Ω–∞–º–∏.
                                    </p>
                                </div>
                                <div>
                                    <h4 className="text-white font-bold mb-6 text-lg">–ö–æ–Ω—Ç–∞–∫—Ç–∏</h4>
                                    <ul className="space-y-4 text-gray-400 text-sm">
                                        <li className="flex items-center gap-3">
                                            <span className="bg-white/5 p-2 rounded-lg"><Icons.Phone size={16} /></span>
                                            <span>+380 93 123 45 67</span>
                                        </li>
                                        <li className="flex items-center gap-3">
                                            <span className="bg-white/5 p-2 rounded-lg text-blue-400"><Icons.Send size={16} /></span>
                                            <a href="#" className="hover:text-white transition">@night_secret_manager</a>
                                        </li>
                                        <li className="flex items-center gap-3">
                                            <span className="bg-white/5 p-2 rounded-lg text-pink-500"><Icons.Instagram size={16} /></span>
                                            <a href="#" className="hover:text-white transition">@night_secret_shop</a>
                                        </li>
                                        <li className="flex items-center gap-3">
                                            <span className="bg-white/5 p-2 rounded-lg"><Icons.Truck size={16} /></span>
                                            <span>–ü—Ä–∞—Ü—é—î–º–æ —â–æ–¥–Ω—è –∑ 10:00 –¥–æ 22:00</span>
                                        </li>
                                    </ul>
                                </div>
                                <div>
                                    <h4 className="text-white font-bold mb-6 text-lg">–ö–ª—ñ—î–Ω—Ç–∞–º</h4>
                                    <ul className="space-y-3 text-gray-400 text-sm">
                                        <li><a href="#" className="hover:text-violet-400 transition">–ü—Ä–æ –Ω–∞—Å</a></li>
                                        <li><a href="#" className="hover:text-violet-400 transition">–û–ø–ª–∞—Ç–∞ —Ç–∞ –¥–æ—Å—Ç–∞–≤–∫–∞</a></li>
                                        <li><a href="#" className="hover:text-violet-400 transition">–ü–æ–≤–µ—Ä–Ω–µ–Ω–Ω—è —Ç–∞ –æ–±–º—ñ–Ω</a></li>
                                        <li><a href="#" className="hover:text-violet-400 transition">–ü–æ–ª—ñ—Ç–∏–∫–∞ –∫–æ–Ω—Ñ—ñ–¥–µ–Ω—Ü—ñ–π–Ω–æ—Å—Ç—ñ</a></li>
                                        <li><a href="#" className="hover:text-violet-400 transition">–î–æ–≥–æ–≤—ñ—Ä –æ—Ñ–µ—Ä—Ç–∏</a></li>
                                    </ul>
                                </div>
                            </div>
                            <div className="border-t border-white/5 pt-8 text-center text-xs text-gray-600 flex flex-col md:flex-row justify-between items-center gap-4">
                                <span>¬© 2024 Night Secret. –í—Å—ñ –ø—Ä–∞–≤–∞ –∑–∞—Ö–∏—â–µ–Ω–æ.</span>
                                <div className="flex items-center gap-2">
                                    <span>18+ –¢—ñ–ª—å–∫–∏ –¥–ª—è –¥–æ—Ä–æ—Å–ª–∏—Ö</span>
                                    <button onClick={() => setShowAdminLogin(true)} className="opacity-20 hover:opacity-100 transition p-2"><Icons.Lock size={12} /></button>
                                </div>
                            </div>
                        </div>
                    </footer>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
